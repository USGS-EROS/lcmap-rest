<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>lcmap.rest.middleware.http-util documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">lcmap.rest</span> <span class="project-version">0.5.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="89-related.html"><div class="inner"><span>Related Projects</span></div></a></li><li class="depth-1 "><a href="99-other-versions.html"><div class="inner"><span>Other Versions</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lcmap</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rest</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></div></li><li class="depth-4 branch"><a href="lcmap.rest.api.auth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth</span></div></a></li><li class="depth-4"><a href="lcmap.rest.api.compatibility.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compatibility</span></div></a></li><li class="depth-5"><a href="lcmap.rest.api.compatibility.wmts.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>wmts</span></div></a></li><li class="depth-4 branch"><a href="lcmap.rest.api.data.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>data</span></div></a></li><li class="depth-4 branch"><a href="lcmap.rest.api.four-oh-four.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>four-oh-four</span></div></a></li><li class="depth-4 branch"><a href="lcmap.rest.api.jobs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jobs</span></div></a></li><li class="depth-4"><a href="lcmap.rest.api.models.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>models</span></div></a></li><li class="depth-5 branch"><a href="lcmap.rest.api.models.ccdc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ccdc</span></div></a></li><li class="depth-5 branch"><a href="lcmap.rest.api.models.ccdc-docker-process.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ccdc-docker-process</span></div></a></li><li class="depth-5 branch"><a href="lcmap.rest.api.models.ccdc-piped-processes.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ccdc-piped-processes</span></div></a></li><li class="depth-5 branch"><a href="lcmap.rest.api.models.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-5 branch"><a href="lcmap.rest.api.models.ndvi.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ndvi</span></div></a></li><li class="depth-5 branch"><a href="lcmap.rest.api.models.sample-docker-process.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sample-docker-process</span></div></a></li><li class="depth-5 branch"><a href="lcmap.rest.api.models.sample-os-process.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sample-os-process</span></div></a></li><li class="depth-5"><a href="lcmap.rest.api.models.sample-piped-processes.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sample-piped-processes</span></div></a></li><li class="depth-4 branch"><a href="lcmap.rest.api.routes.html"><div class="inner"><span class="tree" style="top: -269px;"><span class="top" style="height: 278px;"></span><span class="bottom"></span></span><span>routes</span></div></a></li><li class="depth-4 branch"><a href="lcmap.rest.api.system.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>system</span></div></a></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>v0</span></div></div></li><li class="depth-5 branch"><a href="lcmap.rest.api.v0.auth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth</span></div></a></li><li class="depth-5"><a href="lcmap.rest.api.v0.compatibility.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compatibility</span></div></a></li><li class="depth-6"><a href="lcmap.rest.api.v0.compatibility.wmts.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>wmts</span></div></a></li><li class="depth-5"><a href="lcmap.rest.api.v0.data.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>data</span></div></a></li><li class="depth-6"><a href="lcmap.rest.api.v0.data.surface-reflectance.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>surface-reflectance</span></div></a></li><li class="depth-5 branch"><a href="lcmap.rest.api.v0.four-oh-four.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>four-oh-four</span></div></a></li><li class="depth-5"><a href="lcmap.rest.api.v0.jobs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jobs</span></div></a></li><li class="depth-6 branch"><a href="lcmap.rest.api.v0.jobs.ccdc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ccdc</span></div></a></li><li class="depth-6 branch"><a href="lcmap.rest.api.v0.jobs.ccdc-docker-process.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ccdc-docker-process</span></div></a></li><li class="depth-6 branch"><a href="lcmap.rest.api.v0.jobs.ccdc-piped-processes.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ccdc-piped-processes</span></div></a></li><li class="depth-6 branch"><a href="lcmap.rest.api.v0.jobs.sample-docker-process.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sample-docker-process</span></div></a></li><li class="depth-6 branch"><a href="lcmap.rest.api.v0.jobs.sample-os-process.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sample-os-process</span></div></a></li><li class="depth-6"><a href="lcmap.rest.api.v0.jobs.sample-piped-processes.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sample-piped-processes</span></div></a></li><li class="depth-5"><a href="lcmap.rest.api.v0.models.html"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>models</span></div></a></li><li class="depth-6 branch"><a href="lcmap.rest.api.v0.models.ccdc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ccdc</span></div></a></li><li class="depth-6 branch"><a href="lcmap.rest.api.v0.models.ccdc-docker-process.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ccdc-docker-process</span></div></a></li><li class="depth-6 branch"><a href="lcmap.rest.api.v0.models.ccdc-piped-processes.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ccdc-piped-processes</span></div></a></li><li class="depth-6 branch"><a href="lcmap.rest.api.v0.models.sample-docker-process.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sample-docker-process</span></div></a></li><li class="depth-6 branch"><a href="lcmap.rest.api.v0.models.sample-os-process.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sample-os-process</span></div></a></li><li class="depth-6"><a href="lcmap.rest.api.v0.models.sample-piped-processes.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sample-piped-processes</span></div></a></li><li class="depth-5"><a href="lcmap.rest.api.v0.system.html"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>system</span></div></a></li><li class="depth-3 branch"><a href="lcmap.rest.app.html"><div class="inner"><span class="tree" style="top: -1230px;"><span class="top" style="height: 1239px;"></span><span class="bottom"></span></span><span>app</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth</span></div></div></li><li class="depth-4 branch"><a href="lcmap.rest.auth.nasa.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>nasa</span></div></a></li><li class="depth-4"><a href="lcmap.rest.auth.usgs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>usgs</span></div></a></li><li class="depth-3"><a href="lcmap.rest.components.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>components</span></div></a></li><li class="depth-4 branch"><a href="lcmap.rest.components.httpd.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>httpd</span></div></a></li><li class="depth-4 branch"><a href="lcmap.rest.components.metrics.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metrics</span></div></a></li><li class="depth-4"><a href="lcmap.rest.components.system.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>system</span></div></a></li><li class="depth-3 branch"><a href="lcmap.rest.config.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-3 branch"><a href="lcmap.rest.dev.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dev</span></div></a></li><li class="depth-3 branch"><a href="lcmap.rest.errors.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>errors</span></div></a></li><li class="depth-3 branch"><a href="lcmap.rest.exceptions.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exceptions</span></div></a></li><li class="depth-3"><a href="lcmap.rest.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-4 branch"><a href="lcmap.rest.middleware.content-type.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>content-type</span></div></a></li><li class="depth-4 branch"><a href="lcmap.rest.middleware.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-4 branch current"><a href="lcmap.rest.middleware.http-util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http-util</span></div></a></li><li class="depth-4"><a href="lcmap.rest.middleware.versioned-api.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>versioned-api</span></div></a></li><li class="depth-3 branch"><a href="lcmap.rest.serializer.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>serializer</span></div></a></li><li class="depth-3 branch"><a href="lcmap.rest.system.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>system</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tile</span></div></div></li><li class="depth-4"><a href="lcmap.rest.tile.db.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></a></li><li class="depth-3 branch"><a href="lcmap.rest.types.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>types</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>user</span></div></div></li><li class="depth-4"><a href="lcmap.rest.user.db.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></a></li><li class="depth-3"><a href="lcmap.rest.util.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-accept-regex"><div class="inner"><span>accept-regex</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-accept-version-regex"><div class="inner"><span>accept-version-regex</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-add-error"><div class="inner"><span>add-error</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-add-error-handler"><div class="inner"><span>add-error-handler</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-add-headers"><div class="inner"><span>add-headers</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-add-problem-header"><div class="inner"><span>add-problem-header</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-add-result"><div class="inner"><span>add-result</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-add-status"><div class="inner"><span>add-status</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-append-error"><div class="inner"><span>append-error</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-body-.3Esexp"><div class="inner"><span>body-&gt;sexp</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-errors-.3Esexp"><div class="inner"><span>errors-&gt;sexp</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-get-accept"><div class="inner"><span>get-accept</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-headers-.3Esexp"><div class="inner"><span>headers-&gt;sexp</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-parse-accept"><div class="inner"><span>parse-accept</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-parse-accept-version"><div class="inner"><span>parse-accept-version</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-response"><div class="inner"><span>response</span></div></a></li><li class="depth-1"><a href="lcmap.rest.middleware.http-util.html#var-response-.3Esexp"><div class="inner"><span>response-&gt;sexp</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">lcmap.rest.middleware.http-util</h1><div class="doc"><div class="markdown"><p>Documentation forthcoming</p></div></div><div class="public anchor" id="var-accept-regex"><h3>accept-regex</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Documentation forthcoming</p></div></div></div><div class="public anchor" id="var-accept-version-regex"><h3>accept-version-regex</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Documentation forthcoming</p></div></div></div><div class="public anchor" id="var-add-error"><h3>add-error</h3><div class="usage"><code>(add-error resp error)</code></div><div class="doc"><div class="markdown"><p>Update the response with the given errors.</p></div></div></div><div class="public anchor" id="var-add-error-handler"><h3>add-error-handler</h3><div class="usage"><code>(add-error-handler func ex err-id err-status)</code></div><div class="doc"><div class="markdown"><p>The error handler needs to return a response, since the response headers need to be updated with the problem HTTP content type. This does mean, though, that to support a symmetry-of-results between a function that returns successfully (e.g., login) and the handler that is called in the event of the function raising an exception, each must return the same data type. In other words, (login …) cannot be wrapped in a response, since – when it fails – its error handler will return one. This would result in a regular response upon success and a nested (improper) response upon failure.</p></div></div></div><div class="public anchor" id="var-add-headers"><h3>add-headers</h3><div class="usage"><code>(add-headers resp headers)</code></div><div class="doc"><div class="markdown"><p>Update the response with the given result.</p></div></div></div><div class="public anchor" id="var-add-problem-header"><h3>add-problem-header</h3><div class="usage"><code>(add-problem-header resp &amp; {:keys [mime], :or {mime :json}})</code></div><div class="doc"><div class="markdown"><p>Returns an updated Ring response with the HTTP problem header set for the given mime sub-type.</p>
<p>This is per IETF RFC-7807.</p></div></div></div><div class="public anchor" id="var-add-result"><h3>add-result</h3><div class="usage"><code>(add-result resp result)</code></div><div class="doc"><div class="markdown"><p>Update the response with the given result.</p></div></div></div><div class="public anchor" id="var-add-status"><h3>add-status</h3><div class="usage"><code>(add-status resp status)</code></div><div class="doc"><div class="markdown"><p>Update the response with the given status.</p></div></div></div><div class="public anchor" id="var-append-error"><h3>append-error</h3><div class="usage"><code>(append-error resp error)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-body-.3Esexp"><h3>body-&gt;sexp</h3><div class="usage"><code>(body-&gt;sexp {result :result, errors :errors})</code></div><div class="doc"><div class="markdown"><p>Convert the response body to S-expressions that can be consumed by clojure.data.xml.</p></div></div></div><div class="public anchor" id="var-errors-.3Esexp"><h3>errors-&gt;sexp</h3><div class="usage"><code>(errors-&gt;sexp errors)</code></div><div class="doc"><div class="markdown"><p>Convert the body errors to S-expressions that can be consumed by clojure.data.xml.</p></div></div></div><div class="public anchor" id="var-get-accept"><h3>get-accept</h3><div class="usage"><code>(get-accept request default-version)</code></div><div class="doc"><div class="markdown"><p>Extract the parsed ‘Accept’ headers from a request.</p></div></div></div><div class="public anchor" id="var-headers-.3Esexp"><h3>headers-&gt;sexp</h3><div class="usage"><code>(headers-&gt;sexp headers)</code></div><div class="doc"><div class="markdown"><p>Convert response headers to S-expressions that can be consumed by clojure.data.xml.</p></div></div></div><div class="public anchor" id="var-parse-accept"><h3>parse-accept</h3><div class="usage"><code>(parse-accept string)</code></div><div class="doc"><div class="markdown"><p>Parse a single accept string into a map</p></div></div></div><div class="public anchor" id="var-parse-accept-version"><h3>parse-accept-version</h3><div class="usage"><code>(parse-accept-version default-version string)</code></div><div class="doc"><div class="markdown"><p>Documentation forthcoming</p></div></div></div><div class="public anchor" id="var-response"><h3>response</h3><div class="usage"><code>(response &amp; {:keys [result errors status headers], :or {result nil, errors [], status 200, headers {}}, :as args})</code></div><div class="doc"><div class="markdown"><p>If the developer is inclinded, this function allows one to set the result, errors, headers, and status in one call. Otherwise, one may use individual functions for each (see above), if that better suits one’s needs.</p></div></div></div><div class="public anchor" id="var-response-.3Esexp"><h3>response-&gt;sexp</h3><div class="usage"><code>(response-&gt;sexp {status :status, headers :headers, body :body} &amp; {:keys [root], :or {root :data}})</code></div><div class="doc"><div class="markdown"><p>Converts the clojure.lang.PersistentArrayMap of a Ring repsonse to S-expressions that can be consumed by clojure.data.xml.</p></div></div></div></div></body></html>